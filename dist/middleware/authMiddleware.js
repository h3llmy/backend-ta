function a9_0x1cd6(_0xbac8c2,_0x4b5d4d){const _0x53816b=a9_0x5381();return a9_0x1cd6=function(_0x1cd671,_0x17fe49){_0x1cd671=_0x1cd671-0x122;let _0x4a7232=_0x53816b[_0x1cd671];return _0x4a7232;},a9_0x1cd6(_0xbac8c2,_0x4b5d4d);}(function(_0x2f5985,_0x489e8a){const _0x399f52=a9_0x1cd6,_0x429ae0=_0x2f5985();while(!![]){try{const _0x4eade6=parseInt(_0x399f52(0x136))/0x1*(-parseInt(_0x399f52(0x12f))/0x2)+parseInt(_0x399f52(0x128))/0x3*(parseInt(_0x399f52(0x137))/0x4)+-parseInt(_0x399f52(0x12c))/0x5*(parseInt(_0x399f52(0x131))/0x6)+-parseInt(_0x399f52(0x140))/0x7*(parseInt(_0x399f52(0x127))/0x8)+-parseInt(_0x399f52(0x124))/0x9*(parseInt(_0x399f52(0x134))/0xa)+-parseInt(_0x399f52(0x12a))/0xb+-parseInt(_0x399f52(0x12b))/0xc*(-parseInt(_0x399f52(0x130))/0xd);if(_0x4eade6===_0x489e8a)break;else _0x429ae0['push'](_0x429ae0['shift']());}catch(_0xf22bc4){_0x429ae0['push'](_0x429ae0['shift']());}}}(a9_0x5381,0x37552));function a9_0x5381(){const _0x49b06c=['32AdZhQd','126RrQIeB','headers','4876069UTXdbu','316212tZVyUm','5yVLxqk','type','isActive','2xUoYWM','546YLQMlY','1118178RTyhxR','login','admin','2305110piyEyA','findById','152015VmxmOe','40576YmFRix','select','Bearer','query','Unauthorized','filter','auth','_id\x20status','invalid\x20authorization','514465dyGFvR','public','status','9AOEYoG','authorization','split'];a9_0x5381=function(){return _0x49b06c;};return a9_0x5381();}import a9_0x5cff9e from'../model/userModel.js';import{decodeToken}from'../service/jwtToken.js';import a9_0x51c719 from'../vendor/customError.js';export const auth=async(_0x4a60e3,_0x3824bd,_0x57b249)=>{const _0x2a75cb=a9_0x1cd6;try{const _0x433bee=_0x4a60e3[_0x2a75cb(0x129)][_0x2a75cb(0x125)];if(!_0x433bee){delete _0x4a60e3[_0x2a75cb(0x13a)][_0x2a75cb(0x12e)];const _0x42d867={'status':_0x2a75cb(0x122)};_0x4a60e3[_0x2a75cb(0x13d)]=_0x42d867;}else{if(_0x433bee&&_0x433bee['startsWith'](_0x2a75cb(0x139))){const _0x26d6e9=_0x433bee[_0x2a75cb(0x126)]('\x20')[0x1],_0x2ceecc=decodeToken(_0x26d6e9);if(_0x2ceecc[_0x2a75cb(0x12d)]!=_0x2a75cb(0x132))throw'invalid\x20authorization';const _0x442aee=await a9_0x5cff9e[_0x2a75cb(0x135)](_0x2ceecc['id'])[_0x2a75cb(0x138)](_0x2a75cb(0x13e));if(!_0x442aee)throw _0x2a75cb(0x13f);if(_0x442aee[_0x2a75cb(0x12e)]==![])throw _0x2a75cb(0x13f);_0x442aee[_0x2a75cb(0x123)]!=_0x2a75cb(0x133)&&(_0x442aee[_0x2a75cb(0x13c)]={}),_0x4a60e3[_0x2a75cb(0x13d)]=_0x442aee;}}_0x57b249();}catch(_0x5ddbfb){_0x57b249(new a9_0x51c719(_0x5ddbfb,0x191));}};export const protect=async(_0x288df2,_0x2450af,_0x32cfd1)=>{const _0x402c46=a9_0x1cd6;try{const _0x5a3bb6=_0x288df2[_0x402c46(0x129)]['authorization'];if(!_0x5a3bb6)throw _0x402c46(0x13b);_0x32cfd1();}catch(_0x2a0142){_0x32cfd1(new a9_0x51c719(_0x2a0142,0x191));}};export const isAdmin=async(_0x330b0e,_0x217f4e,_0x1973e7)=>{const _0x478c0c=a9_0x1cd6;try{if(_0x330b0e[_0x478c0c(0x13d)]['status']!='admin')throw _0x478c0c(0x13b);_0x1973e7();}catch(_0x286eeb){_0x1973e7(new a9_0x51c719(_0x286eeb,0x191));}};