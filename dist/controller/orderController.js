(function(_0x532b04,_0x4383cc){const _0x5bd633=a5_0x18e3,_0x445094=_0x532b04();while(!![]){try{const _0x3264aa=parseInt(_0x5bd633(0xb5))/0x1*(parseInt(_0x5bd633(0xd0))/0x2)+-parseInt(_0x5bd633(0xf1))/0x3*(parseInt(_0x5bd633(0xb0))/0x4)+parseInt(_0x5bd633(0xa8))/0x5+-parseInt(_0x5bd633(0xa5))/0x6+-parseInt(_0x5bd633(0xab))/0x7*(-parseInt(_0x5bd633(0xb1))/0x8)+parseInt(_0x5bd633(0x99))/0x9+-parseInt(_0x5bd633(0xc1))/0xa;if(_0x3264aa===_0x4383cc)break;else _0x445094['push'](_0x445094['shift']());}catch(_0x5de374){_0x445094['push'](_0x445094['shift']());}}}(a5_0x11dd,0x93efb));import{successResponse}from'../vendor/response.js';import a5_0x5416a9 from'../model/orderModel.js';import a5_0x4a2043 from'../model/productModel.js';import a5_0x1c0228 from'../vendor/validator.js';import a5_0x542371 from'../vendor/customError.js';import{deleteFile,saveFile,uploadFile}from'../vendor/uploadFile.js';function a5_0x18e3(_0x4a4976,_0x60333f){const _0x11dd33=a5_0x11dd();return a5_0x18e3=function(_0x18e399,_0x1bd6e0){_0x18e399=_0x18e399-0x78;let _0x5ec812=_0x11dd33[_0x18e399];return _0x5ec812;},a5_0x18e3(_0x4a4976,_0x60333f);}import a5_0x539cd3 from'../service/nodeMailler.js';import a5_0x3a088d from'../model/userModel.js';import a5_0x188e2f from'../vendor/createCsv.js';import a5_0x93afe1 from'../model/discountModel.js';import{generatePayment,updatePayment}from'../service/paymentMidtrans.js';import a5_0x3fc870 from'mongoose';import a5_0x1cbc0d from'../model/collectionModel.js';import a5_0x36d50f from'../model/categoriesModel.js';export const add=async(_0x1573b5,_0x31a0d6)=>{const _0x405eaa=a5_0x18e3;a5_0x1c0228(_0x1573b5[_0x405eaa(0xe2)],{'productId':{'required':!![],'type':String},'discountId':{'type':String},'note':{'required':!![],'type':String}});const _0x148fdb=await a5_0x3fc870[_0x405eaa(0x91)]();_0x148fdb[_0x405eaa(0x80)]();try{const _0x3cfa27=await a5_0x4a2043[_0x405eaa(0xf0)]({'_id':_0x1573b5[_0x405eaa(0xe2)][_0x405eaa(0x85)]})[_0x405eaa(0x78)](_0x405eaa(0x7f))[_0x405eaa(0xe7)](new a5_0x542371(_0x405eaa(0xf4),0x194));let _0x5ccbca=_0x3cfa27[_0x405eaa(0xbd)],_0x24e427;if(_0x1573b5[_0x405eaa(0xe2)][_0x405eaa(0xbb)]){const _0x17f857=await a5_0x93afe1['findOne']({'_id':_0x1573b5['body']['discountId'],'startAt':{'$lte':new Date()},'expiredAt':{'$gte':new Date()}})[_0x405eaa(0xe7)](new a5_0x542371('Discount\x20not\x20found',0x1a6));_0x5ccbca=_0x5ccbca-Math[_0x405eaa(0x9d)](_0x5ccbca*_0x17f857['percentage']/0x64),_0x24e427={'discountId':_0x17f857[_0x405eaa(0x97)],'name':_0x17f857[_0x405eaa(0xbf)],'percentage':_0x17f857[_0x405eaa(0xaa)]};}const _0x2762f7=await a5_0x5416a9['create']({'customer':_0x1573b5['auth'][_0x405eaa(0x97)],'productId':_0x3cfa27[_0x405eaa(0x97)],'productName':_0x3cfa27[_0x405eaa(0xbf)],'productCategoryId':_0x3cfa27['category'][_0x405eaa(0x97)],'productCategory':_0x3cfa27[_0x405eaa(0x7f)][_0x405eaa(0xbf)],'dayWork':_0x3cfa27['dayWork'],'note':_0x1573b5['body'][_0x405eaa(0x93)],'price':_0x5ccbca,'maxRevision':_0x3cfa27[_0x405eaa(0xad)],'discount':_0x24e427,'status':{'ordered':new Date()}}),_0x18adae={'transaction_details':{'order_id':_0x2762f7[_0x405eaa(0x97)],'gross_amount':_0x2762f7['price']},'item_details':[{'id':_0x3cfa27[_0x405eaa(0x97)],'price':_0x2762f7['price'],'quantity':0x1,'name':_0x2762f7['productName'],'category':_0x2762f7['productCategory']}]},_0x475ae7=await generatePayment(_0x18adae);await _0x148fdb[_0x405eaa(0xa2)](),_0x31a0d6[_0x405eaa(0xdd)](successResponse(_0x475ae7));}catch(_0x5a5b99){_0x148fdb[_0x405eaa(0xb2)]();throw _0x5a5b99;}finally{_0x148fdb['endSession']();}};export const notification=async()=>{const _0x5afabd=a5_0x18e3;try{const _0x514bb7=new Date();_0x514bb7[_0x5afabd(0x9c)](0x0,0x0,0x0,0x0);const _0x1947ea=new Date(_0x514bb7);_0x1947ea['setDate'](_0x514bb7[_0x5afabd(0x79)]()-0x1);const _0x24093a=await a5_0x5416a9['find']({'orderStatus':{'$in':['progress']},'deadline':{'$lt':_0x514bb7,'$gte':_0x1947ea}})['populate'](_0x5afabd(0xce)),_0x58d00a=await a5_0x3a088d[_0x5afabd(0xf0)]({'status':_0x5afabd(0xe8)});for(const _0x1c9693 of _0x24093a){const _0x3500c9={'to':_0x58d00a[_0x5afabd(0xd2)],'subject':_0x5afabd(0x7c),'html':{'orderId':_0x1c9693[_0x5afabd(0x97)],'customer':_0x1c9693[_0x5afabd(0xce)][_0x5afabd(0xc6)],'productName':_0x1c9693['productName'],'orderStatus':_0x1c9693[_0x5afabd(0xa6)]}};a5_0x539cd3(_0x3500c9,_0x5afabd(0x8a));}}catch(_0x4549c2){console[_0x5afabd(0xa1)](_0x4549c2);}};export const list=async(_0x665c65,_0x449981)=>{const _0x2cedcd=a5_0x18e3;let _0x5ad569={..._0x665c65[_0x2cedcd(0xae)][_0x2cedcd(0xf8)]};_0x665c65[_0x2cedcd(0x7e)]['orderStatus']&&(_0x5ad569={..._0x5ad569,'orderStatus':_0x665c65[_0x2cedcd(0x7e)]['orderStatus']});_0x665c65[_0x2cedcd(0xae)][_0x2cedcd(0xde)]!==_0x2cedcd(0xe8)&&(_0x5ad569={..._0x5ad569,'customer':_0x665c65[_0x2cedcd(0xae)]['id']});_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0x88)]&&(_0x5ad569={..._0x5ad569,'$or':[{'productName':{'$regex':_0x665c65[_0x2cedcd(0x7e)]['search'],'$options':'i'}}]});if(_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0xd8)]||_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0xfa)]){const _0x26f02f=_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0xd8)]?new Date(_0x665c65[_0x2cedcd(0x7e)]['datefrom']):null,_0x3c9976=_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0xfa)]?new Date(_0x665c65[_0x2cedcd(0x7e)][_0x2cedcd(0xfa)]):null;if(_0x26f02f&&_0x3c9976&&_0x26f02f>_0x3c9976)throw new a5_0x542371(_0x2cedcd(0xe9),0x190,{'from':_0x2cedcd(0x9b)});if(_0x26f02f&&_0x26f02f>new Date())throw new a5_0x542371(_0x2cedcd(0xe9),0x190,{'from':_0x2cedcd(0xa3)});const _0x2ee6cd={};_0x26f02f&&(_0x2ee6cd[_0x2cedcd(0xb4)]=_0x26f02f),_0x3c9976&&(_0x2ee6cd[_0x2cedcd(0x7d)]=_0x3c9976),_0x5ad569={..._0x5ad569,'createdAt':_0x2ee6cd};}const _0x472c46=await a5_0x5416a9['paginate'](_0x5ad569,_0x665c65[_0x2cedcd(0x7e)],{'populate':['customer','productId'],'sort':{'createdAt':_0x2cedcd(0x8d)}});_0x449981['json'](successResponse(_0x472c46));};export const listPerMonth=async(_0x1b068b,_0x49d5f6)=>{const _0x201b5e=a5_0x18e3,_0x29d0ae=new Date()[_0x201b5e(0xed)](),_0x22142e=await a5_0x5416a9[_0x201b5e(0xb9)]([{'$match':{'status.done':{'$exists':!![]},'status.done':{'$gte':new Date(_0x29d0ae+_0x201b5e(0xdb)),'$lte':new Date(_0x29d0ae+_0x201b5e(0x87))}}},{'$group':{'_id':{'$month':_0x201b5e(0x9f)},'totalIncome':{'$sum':_0x201b5e(0xe6)}}}]),_0x30744a={0x1:'Jan',0x2:_0x201b5e(0xe0),0x3:_0x201b5e(0xea),0x4:_0x201b5e(0x8f),0x5:_0x201b5e(0x9a),0x6:_0x201b5e(0xd3),0x7:_0x201b5e(0x84),0x8:_0x201b5e(0xf9),0x9:_0x201b5e(0xd4),0xa:_0x201b5e(0x95),0xb:_0x201b5e(0xa0),0xc:_0x201b5e(0xcb)},_0x3e8ec3=[];_0x22142e[_0x201b5e(0xaf)](_0x3b28cd=>{const _0x4bd1e=_0x201b5e;_0x3e8ec3[_0x4bd1e(0xef)]({'month':_0x30744a[_0x3b28cd[_0x4bd1e(0x97)]],'totalIncome':_0x3b28cd[_0x4bd1e(0xf7)]});});for(let _0x4fe4de=0x1;_0x4fe4de<=0xc;_0x4fe4de++){const _0x542f10=_0x3e8ec3[_0x201b5e(0xe5)](_0x3e2fed=>_0x3e2fed[_0x201b5e(0x81)]===_0x30744a[_0x4fe4de]);!_0x542f10&&_0x3e8ec3[_0x201b5e(0xef)]({'month':_0x30744a[_0x4fe4de],'totalIncome':0x0});}_0x3e8ec3[_0x201b5e(0xbc)]((_0x18014c,_0xbf8872)=>Object[_0x201b5e(0xca)](_0x30744a)['indexOf'](_0x18014c[_0x201b5e(0x81)])-Object[_0x201b5e(0xca)](_0x30744a)[_0x201b5e(0xc2)](_0xbf8872['month'])),_0x49d5f6['json'](successResponse(_0x3e8ec3));};export const listPerYear=async(_0x1dd45d,_0x3fdbd5)=>{const _0x287320=a5_0x18e3,_0x3201b0=new Date()[_0x287320(0xed)](),_0x5cd321=_0x3201b0-0xa,_0x29b4f9=await a5_0x5416a9['aggregate']([{'$match':{'status.done':{'$exists':!![]},'status.done':{'$gte':new Date(_0x5cd321+_0x287320(0xdb)),'$lte':new Date(_0x3201b0+'-12-31')}}},{'$group':{'_id':{'$year':'$status.done'},'totalIncome':{'$sum':_0x287320(0xe6)}}}]),_0x479053=_0x29b4f9[_0x287320(0xc8)](_0x3a2fe3=>({'year':_0x3a2fe3[_0x287320(0x97)],'totalIncome':_0x3a2fe3[_0x287320(0xf7)]}));_0x479053['sort']((_0x5d338a,_0x5b8938)=>_0x5d338a[_0x287320(0x98)]-_0x5b8938[_0x287320(0x98)]),_0x3fdbd5[_0x287320(0xdd)](successResponse(_0x479053));};export const total=async(_0xaa1271,_0xc1f410)=>{const _0x343764=a5_0x18e3,_0x3d72f8=await a5_0x5416a9[_0x343764(0xc3)]();_0xc1f410[_0x343764(0xdd)](successResponse(_0x3d72f8));};export const detail=async(_0x4d320e,_0x44bdfe)=>{const _0x34c065=a5_0x18e3;let _0x106878={'_id':_0x4d320e['params'][_0x34c065(0xdf)]};_0x4d320e['auth'][_0x34c065(0xde)]!=='admin'&&(_0x106878={..._0x106878,'customer':_0x4d320e['auth'][_0x34c065(0x97)]});const _0x290323=await a5_0x5416a9[_0x34c065(0xf0)](_0x106878)[_0x34c065(0x78)](_0x34c065(0xce))[_0x34c065(0xe7)](new a5_0x542371('Order\x20not\x20found',0x194));_0x44bdfe[_0x34c065(0xdd)](successResponse(_0x290323));};export const createReport=async(_0x23a31c,_0x3725b2)=>{const _0x495e15=a5_0x18e3;a5_0x1c0228(_0x23a31c['body'],{'from':{'type':Date},'until':{'type':Date}});let _0xbdfd78={'orderStatus':_0x495e15(0xe3)};if(_0x23a31c[_0x495e15(0xe2)][_0x495e15(0xa4)]||_0x23a31c[_0x495e15(0xe2)]['until']){const _0x291d4a=_0x23a31c[_0x495e15(0xe2)]['from']?new Date(_0x23a31c[_0x495e15(0xe2)]['from']):null,_0x844fdd=_0x23a31c[_0x495e15(0xe2)][_0x495e15(0xf2)]?new Date(_0x23a31c[_0x495e15(0xe2)]['until']):null;if(_0x291d4a&&_0x844fdd&&_0x291d4a>_0x844fdd)throw new a5_0x542371('Error\x20validations',0x190,{'from':_0x495e15(0x9b)});if(_0x291d4a&&_0x291d4a>new Date())throw new a5_0x542371(_0x495e15(0xe9),0x190,{'from':_0x495e15(0xa3)});const _0x2d2871={};_0x291d4a&&(_0x2d2871[_0x495e15(0xb4)]=_0x291d4a),_0x844fdd&&(_0x2d2871[_0x495e15(0x7d)]=_0x844fdd),_0xbdfd78={..._0xbdfd78,'status.done':_0x2d2871};}const _0x269919='report-'+Date[_0x495e15(0x9e)](),_0xdbed63=a5_0x5416a9[_0x495e15(0xe5)](_0xbdfd78)['populate'](_0x495e15(0xce))[_0x495e15(0xec)]({'batchSize':0x64});let _0x3a70ff=0x0;_0xdbed63['on'](_0x495e15(0xe4),async _0x4206d9=>{const _0x3cb44d=_0x495e15;a5_0x188e2f(_0x269919,{'Customer':_0x4206d9['customer'][_0x3cb44d(0xc6)],'Product\x20Name':_0x4206d9[_0x3cb44d(0xf6)],'Product\x20Category':_0x4206d9[_0x3cb44d(0xb3)],'Discount\x20Name':_0x4206d9[_0x3cb44d(0xba)][_0x3cb44d(0xbf)]||'','Discount\x20Percentage':_0x4206d9['discount'][_0x3cb44d(0xaa)]||'','Order\x20Date':_0x4206d9[_0x3cb44d(0xc9)][_0x3cb44d(0xf5)](),'Price':_0x4206d9[_0x3cb44d(0xbd)]}),_0x3a70ff+=_0x4206d9[_0x3cb44d(0xbd)];}),_0xdbed63['on'](_0x495e15(0x96),()=>{const _0x5f415d=_0x495e15,_0x33b825=a5_0x188e2f(_0x269919,{'Customer':'','Product\x20Name':'','Product\x20Category':'','Discount\x20Name':'','Discount\x20Percentage':'','Order\x20Date':_0x5f415d(0x90),'totalIncome':_0x3a70ff});_0x3725b2[_0x5f415d(0xdd)](successResponse(_0x33b825)),setTimeout(()=>{const _0x2e8c35=_0x5f415d;deleteFile(_0x33b825[_0x2e8c35(0x82)]);},0x493e0);});};export const updateRevision=async(_0x501016,_0x1239e6)=>{const _0x481d33=a5_0x18e3;a5_0x1c0228(_0x501016[_0x481d33(0xe2)],{'revisionNote':{'type':String,'required':!![]}});const _0x59e7cf=await a5_0x5416a9[_0x481d33(0xf0)]({'_id':_0x501016[_0x481d33(0xb8)][_0x481d33(0xdf)],'customer':_0x501016['auth'][_0x481d33(0x97)]})[_0x481d33(0xe7)](new a5_0x542371(_0x481d33(0xda),0x194));_0x59e7cf[_0x481d33(0xa6)]!==_0x481d33(0x86)&&new a5_0x542371(_0x481d33(0x7a)+_0x59e7cf[_0x481d33(0xa6)],0x190),_0x59e7cf['maxRevision']<_0x59e7cf[_0x481d33(0x89)]&&new a5_0x542371(_0x481d33(0xf3)+_0x59e7cf[_0x481d33(0xad)]+_0x481d33(0xcd),0x190),_0x59e7cf[_0x481d33(0x89)]+=0x1,_0x59e7cf[_0x481d33(0xd9)][_0x481d33(0xef)](_0x501016['body'][_0x481d33(0xd9)]),_0x59e7cf[_0x481d33(0xa6)]=_0x481d33(0xa9),_0x59e7cf[_0x481d33(0xde)][_0x481d33(0xa9)]=new Date(),await _0x59e7cf[_0x481d33(0xb6)](),_0x1239e6[_0x481d33(0xdd)](successResponse(_0x59e7cf,'Order\x20updated'));};export const updatePreview=async(_0x58c291,_0x31247a)=>{const _0x1e7ca1=a5_0x18e3;a5_0x1c0228(_0x58c291['files'],{'productPreview':{'required':!![]}});const _0x3349c8=await a5_0x5416a9[_0x1e7ca1(0xf0)]({'_id':_0x58c291['params'][_0x1e7ca1(0xdf)]})[_0x1e7ca1(0x78)](_0x1e7ca1(0xce))[_0x1e7ca1(0xe7)](new a5_0x542371(_0x1e7ca1(0xda),0x194));if(_0x3349c8['orderStatus']===_0x1e7ca1(0xe3))throw new a5_0x542371('order\x20already\x20'+_0x3349c8['orderStatus']);let _0x275f0b;Number(_0x3349c8['maxRevision'])-Number(_0x3349c8[_0x1e7ca1(0x89)])<=0x0?_0x275f0b=uploadFile(_0x58c291[_0x1e7ca1(0xbe)]['productPreview'],{'isPrivate':!![]}):_0x275f0b=uploadFile(_0x58c291[_0x1e7ca1(0xbe)][_0x1e7ca1(0xc5)]);_0x3349c8[_0x1e7ca1(0xc5)]&&deleteFile(_0x3349c8['productPreview']);if(Number(_0x3349c8[_0x1e7ca1(0xad)])-Number(_0x3349c8['totalRevision'])<=0x0){_0x3349c8[_0x1e7ca1(0xa6)]=_0x1e7ca1(0xe3),_0x3349c8[_0x1e7ca1(0xde)][_0x1e7ca1(0xe3)]=new Date();const _0x208462=await a5_0x1cbc0d[_0x1e7ca1(0xb7)]({'productUrl':_0x275f0b[_0x1e7ca1(0x83)],'productName':_0x3349c8[_0x1e7ca1(0xf6)],'productCategory':_0x3349c8[_0x1e7ca1(0xb3)]}),_0x3d1cd7=await a5_0x3a088d[_0x1e7ca1(0xf0)]({'_id':_0x3349c8[_0x1e7ca1(0xce)][_0x1e7ca1(0x97)]});_0x3d1cd7['collections'][_0x1e7ca1(0xef)](_0x208462['_id']),_0x3349c8[_0x1e7ca1(0xc5)]=undefined,await _0x3d1cd7['save']();}else _0x3349c8[_0x1e7ca1(0xc5)]=_0x275f0b[_0x1e7ca1(0x83)],_0x3349c8['orderStatus']=_0x1e7ca1(0x86);const _0x5d73a4=await _0x3349c8[_0x1e7ca1(0xb6)]();saveFile(_0x275f0b),_0x31247a[_0x1e7ca1(0xdd)](successResponse(_0x5d73a4,_0x1e7ca1(0xdc)));};export const updateDone=async(_0x31b9d1,_0x505127)=>{const _0x34004e=a5_0x18e3;a5_0x1c0228(_0x31b9d1[_0x34004e(0xbe)],{'proudctFile':{'required':!![]}});const _0x38f1d2=await a5_0x3fc870[_0x34004e(0x91)]();_0x38f1d2[_0x34004e(0x80)]();try{const _0x263736=await a5_0x5416a9[_0x34004e(0xf0)]({'_id':_0x31b9d1[_0x34004e(0xb8)][_0x34004e(0xdf)]})['orFail'](new a5_0x542371(_0x34004e(0xee),0x194));if(_0x263736[_0x34004e(0xa6)]!==_0x34004e(0xac))throw new a5_0x542371('order\x20must\x20accept\x20first\x20before\x20done',0x190);_0x263736[_0x34004e(0xa6)]=_0x34004e(0xe3),_0x263736[_0x34004e(0xde)][_0x34004e(0xe3)]=new Date();const _0x3fb4bb=uploadFile(_0x31b9d1['files'][_0x34004e(0x8e)],{'isPrivate':!![]}),_0x4de75e=await a5_0x36d50f['findOne']({'_id':_0x263736[_0x34004e(0xd5)]});_0x4de75e['sold']+=0x1,await _0x4de75e['save']();const _0x3de91f=await a5_0x1cbc0d[_0x34004e(0xb7)]({'productUrl':_0x3fb4bb[_0x34004e(0x83)],'productName':_0x263736['productName'],'productCategory':_0x263736[_0x34004e(0xb3)]}),_0xdad470=await a5_0x3a088d[_0x34004e(0xf0)]({'_id':_0x263736[_0x34004e(0xce)]});deleteFile(_0x263736?.[_0x34004e(0xc5)]),_0x263736[_0x34004e(0xc5)]=undefined,await _0x263736[_0x34004e(0xb6)](),_0xdad470[_0x34004e(0xcf)][_0x34004e(0xef)](_0x3de91f['_id']),await _0xdad470['save'](),saveFile(_0x3fb4bb),await _0x38f1d2[_0x34004e(0xa2)](),_0x505127[_0x34004e(0xdd)](successResponse(_0x263736));}catch(_0x374174){_0x38f1d2[_0x34004e(0xb2)]();throw _0x374174;}finally{_0x38f1d2[_0x34004e(0xc4)]();}};export const updateAccept=async(_0x5d0600,_0x236adf)=>{const _0x55fac7=a5_0x18e3,_0x4da8a3=a5_0x1c0228(_0x5d0600[_0x55fac7(0xb8)],{'order_id':{'type':String}}),_0x440124=await a5_0x5416a9['findOne']({'_id':_0x4da8a3[_0x55fac7(0xdf)],'orderStatus':_0x55fac7(0x86),'customer':_0x5d0600[_0x55fac7(0xae)]['_id']})['orFail'](new a5_0x542371(_0x55fac7(0xda),0x194));_0x440124['orderStatus']='accept',_0x440124[_0x55fac7(0xde)][_0x55fac7(0xac)]=new Date();const _0x4fa5e4=await _0x440124[_0x55fac7(0xb6)]();_0x236adf['json'](successResponse(_0x4fa5e4,_0x55fac7(0x92)));};function a5_0x11dd(){const _0x1eeb45=['Preview\x20uploaded','json','status','order_id','Feb','deadline','body','done','data','find','$price','orFail','admin','Error\x20validations','Mar','transaction_status','cursor','getFullYear','order\x20not\x20found','push','findOne','147ttxiBQ','until','revision\x20reach\x20limit\x20','Product\x20not\x20found','toDateString','productName','totalIncome','filter','Aug','dateuntil','populate','getDate','order\x20already\x20','setDate','Order\x20Deadline','$lte','query','category','startTransaction','month','fileUrl','filePath','Jul','productId','sended','-12-31','search','totalRevision','orderDeadline.html','cancelled','settlement','desc','proudctFile','Apr','Total\x20Income','startSession','Order\x20updated','note','failed','Okt','end','_id','year','6807186HFaYQo','Mei','From\x20date\x20cannot\x20be\x20greater\x20than\x20until\x20date','setHours','round','now','$status.done','Nov','error','commitTransaction','From\x20date\x20cannot\x20be\x20greater\x20than\x20today','from','6984306AMHbCy','orderStatus','cancel','3601420ItEslB','revision','percentage','3348506dbkTIJ','accept','maxRevision','auth','forEach','53624quCMpy','16aTtNER','abortTransaction','productCategory','$gte','4qCBntP','save','create','params','aggregate','discount','discountId','sort','price','files','name','dayWork','9431060KmtTaM','indexOf','countDocuments','endSession','productPreview','username','expire','map','createdAt','values','Des','deny','\x20times','customer','collections','468322qEwryQ','paid','email','Jun','Sep','productCategoryId','transaction_id','progress','datefrom','revisionNote','Order\x20not\x20found','-01-01'];a5_0x11dd=function(){return _0x1eeb45;};return a5_0x11dd();}export const updateProgress=async(_0x4cc7bc,_0x229923)=>{const _0x5b04ff=a5_0x18e3,_0x579c9a=await a5_0x5416a9[_0x5b04ff(0xf0)]({'_id':_0x4cc7bc[_0x5b04ff(0xb8)]['order_id']}),_0x347a48=new Date(),_0x493bf7=new Date();_0x493bf7[_0x5b04ff(0x7b)](_0x347a48[_0x5b04ff(0x79)]()+_0x579c9a[_0x5b04ff(0xc0)]),_0x579c9a['orderStatus']=_0x5b04ff(0xd7),_0x579c9a[_0x5b04ff(0xde)][_0x5b04ff(0xd7)]=_0x347a48,_0x579c9a[_0x5b04ff(0xe1)]=_0x493bf7,await _0x579c9a[_0x5b04ff(0xb6)](),_0x229923[_0x5b04ff(0xdd)](successResponse(_0x579c9a));};export const paymentCallback=async(_0x58334d,_0x4587af)=>{const _0x31b347=a5_0x18e3,_0x166d4f=await updatePayment({'transaction_id':_0x58334d[_0x31b347(0xe2)][_0x31b347(0xd6)]}),_0x386c09=await a5_0x5416a9[_0x31b347(0xf0)]({'_id':_0x166d4f['order_id']});switch(_0x166d4f[_0x31b347(0xeb)]){case _0x31b347(0x8c):_0x386c09[_0x31b347(0xa6)]=_0x31b347(0xd1),_0x386c09[_0x31b347(0xde)]['paid']=new Date();break;case'capture':_0x386c09['orderStatus']='paid',_0x386c09[_0x31b347(0xde)]['paid']=new Date();break;case _0x31b347(0xcc):_0x386c09[_0x31b347(0xa6)]=_0x31b347(0x8b),_0x386c09[_0x31b347(0xde)][_0x31b347(0x8b)]=new Date();break;case _0x31b347(0xa7):_0x386c09['orderStatus']=_0x31b347(0x8b),_0x386c09[_0x31b347(0xde)][_0x31b347(0x8b)]=new Date();break;case _0x31b347(0xc7):_0x386c09[_0x31b347(0xa6)]=_0x31b347(0x94),_0x386c09[_0x31b347(0xde)][_0x31b347(0x94)]=new Date();break;case'failure':_0x386c09[_0x31b347(0xa6)]=_0x31b347(0x94),_0x386c09[_0x31b347(0xde)][_0x31b347(0x94)]=new Date();break;}await _0x386c09[_0x31b347(0xb6)](),_0x4587af[_0x31b347(0x96)]();};